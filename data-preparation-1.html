<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Data Preparation | Coding Challenge: a Survival Analysis on Simulated Cancer Data</title>
  <meta name="description" content="2 Data Preparation | Coding Challenge: a Survival Analysis on Simulated Cancer Data" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Data Preparation | Coding Challenge: a Survival Analysis on Simulated Cancer Data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Data Preparation | Coding Challenge: a Survival Analysis on Simulated Cancer Data" />
  
  
  

<meta name="author" content="Danny Scarponi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="cohort-description-1.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script language="javascript"> 
    function toggle(id) {
        var ele = document.getElementById("toggleText" + id);
        var text = document.getElementById("displayText" + id);
        var buttonText = text.innerHTML.replace("Show: ", "");
        buttonText = buttonText.replace("Hide: ", "");
        if(ele.style.display == "block") {
            ele.style.display = "none";
            text.innerHTML = "Show: " + buttonText;
        } else {
            ele.style.display = "block";
            text.innerHTML = "Hide: " + buttonText;
        }
    } 
</script>

<script language="javascript">
    function openCode(evt, codeName, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent" + id);
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks" + id);
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(codeName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>

<script language="javascript">
    function hide(id){
        document.getElementById(id).style.display = "none";
    }
</script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Summary</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-preparation"><i class="fa fa-check"></i><b>1.1</b> Data Preparation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#cohort-description"><i class="fa fa-check"></i><b>1.2</b> Cohort Description</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-imputation"><i class="fa fa-check"></i><b>1.3</b> Data Imputation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#survival-analysis"><i class="fa fa-check"></i><b>1.4</b> Survival Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-preparation-1.html"><a href="data-preparation-1.html"><i class="fa fa-check"></i><b>2</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-preparation-1.html"><a href="data-preparation-1.html#medication-variable"><i class="fa fa-check"></i><b>2.1</b> Medication Variable</a></li>
<li class="chapter" data-level="2.2" data-path="data-preparation-1.html"><a href="data-preparation-1.html#dates-variables"><i class="fa fa-check"></i><b>2.2</b> Dates Variables</a></li>
<li class="chapter" data-level="2.3" data-path="data-preparation-1.html"><a href="data-preparation-1.html#demographic-variables"><i class="fa fa-check"></i><b>2.3</b> Demographic Variables</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cohort-description-1.html"><a href="cohort-description-1.html"><i class="fa fa-check"></i><b>3</b> Cohort Description</a></li>
<li class="chapter" data-level="4" data-path="data-imputation-1.html"><a href="data-imputation-1.html"><i class="fa fa-check"></i><b>4</b> Data Imputation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-imputation-1.html"><a href="data-imputation-1.html#multiple-imputation"><i class="fa fa-check"></i><b>4.1</b> Multiple Imputation</a></li>
<li class="chapter" data-level="4.2" data-path="data-imputation-1.html"><a href="data-imputation-1.html#checking-imputed-data"><i class="fa fa-check"></i><b>4.2</b> Checking Imputed Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html"><i class="fa fa-check"></i><b>5</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#univariate-analysis"><i class="fa fa-check"></i><b>5.1</b> Univariate Analysis</a></li>
<li class="chapter" data-level="5.2" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#cox-multiple-regression"><i class="fa fa-check"></i><b>5.2</b> Cox Multiple Regression</a></li>
<li class="chapter" data-level="5.3" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#verifying-assumptions"><i class="fa fa-check"></i><b>5.3</b> Verifying Assumptions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#proportional-hazards"><i class="fa fa-check"></i><b>5.3.1</b> Proportional Hazards</a></li>
<li class="chapter" data-level="5.3.2" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#linearity"><i class="fa fa-check"></i><b>5.3.2</b> Linearity</a></li>
<li class="chapter" data-level="5.3.3" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#influential-observations"><i class="fa fa-check"></i><b>5.3.3</b> Influential Observations</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Sensitivity Analysis</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Coding Challenge: a Survival Analysis on Simulated Cancer Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-preparation-1" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Data Preparation</h1>
<p>We have dataframes <code>medications</code>, <code>dates</code> and <code>demographics</code> corresponding to the three csv files provided. Let’s look at their structure:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-preparation-1.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(medications)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  2 variables:
##  $ id             : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ medication_name: chr  &quot;crizotinib&quot; &quot;crizotinib&quot; &quot;crizotinib&quot; &quot;entrectinib&quot; ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-preparation-1.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dates)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  4 variables:
##  $ id                  : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ first_diagnosis_date: chr  &quot;2021-08-30&quot; &quot;2000-05-12&quot; &quot;2016-10-25&quot; &quot;2001-12-24&quot; ...
##  $ death_date          : chr  &quot;2023-03-26&quot; &quot;&quot; &quot;2017-04-16&quot; &quot;&quot; ...
##  $ end_date            : chr  &quot;&quot; &quot;2002-02-23&quot; &quot;&quot; &quot;2002-12-08&quot; ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-preparation-1.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(demographics)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  6 variables:
##  $ id      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ age     : int  61 62 57 76 56 54 71 69 68 61 ...
##  $ sex     : int  1 0 0 1 1 0 0 1 1 0 ...
##  $ ph.ecog : int  1 0 1 2 1 0 0 2 1 1 ...
##  $ ph.karno: int  90 95 89 66 80 100 96 81 68 84 ...
##  $ wt.loss : num  0.964 18.004 17.372 3.576 8.679 ...</code></pre>
<p>All dataframes have 500 observations. Let us merge them into a unique dataframe, according to their <code>id</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-preparation-1.html#cb7-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(demographics, medications, <span class="at">by=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb7-2"><a href="data-preparation-1.html#cb7-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(merged, dates, <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p>Finally we change the column name <code>medication_name</code> to <code>medication</code>, since there is no risk of confusion (having only one column referring to medications). Similarly, we rename <code>end_date</code> to <code>end</code>, <code>first_diagnosis_date</code> to <code>first_diag</code> and <code>death_date</code> to <code>death</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-preparation-1.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="st">&quot;medication&quot;</span></span>
<span id="cb8-2"><a href="data-preparation-1.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="st">&quot;first_diag&quot;</span></span>
<span id="cb8-3"><a href="data-preparation-1.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="st">&quot;death&quot;</span></span>
<span id="cb8-4"><a href="data-preparation-1.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="st">&quot;end&quot;</span></span></code></pre></div>
<div id="medication-variable" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Medication Variable</h2>
<p>Let’s explore the <code>medication</code> variable:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data-preparation-1.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(merged<span class="sc">$</span>medication)</span></code></pre></div>
<pre><code>## 
##  crizotinab  crizotinib entrectinib Entrectinib 
##          20         226         205          49</code></pre>
<p>We see that there are no missing data and that each medication is reported in two different ways. Let’s uniformise that:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-preparation-1.html#cb11-1" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>medication[merged<span class="sc">$</span>medication<span class="sc">==</span><span class="st">&quot;crizotinab&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Crizotinib&quot;</span> </span>
<span id="cb11-2"><a href="data-preparation-1.html#cb11-2" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>medication[merged<span class="sc">$</span>medication<span class="sc">==</span><span class="st">&quot;Entrectinib&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Entrectinib&quot;</span> </span>
<span id="cb11-3"><a href="data-preparation-1.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(merged<span class="sc">$</span>medication)</span></code></pre></div>
<pre><code>## 
##  crizotinib  Crizotinib entrectinib Entrectinib 
##         226          20         205          49</code></pre>
</div>
<div id="dates-variables" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Dates Variables</h2>
<p>Let’s now examine the three variables related to time:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-preparation-1.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(merged<span class="sc">$</span>first_diag))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-preparation-1.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged<span class="sc">$</span>end <span class="sc">!=</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 188</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-preparation-1.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged<span class="sc">$</span>death <span class="sc">!=</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 315</code></pre>
<p>We see that no participant has first diagnosis date missing. We also note that we must have three participants for which we have both an end date and a death date. Let’s investigate these observations:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-preparation-1.html#cb19-1" aria-hidden="true" tabindex="-1"></a>merged <span class="sc">%&gt;%</span> <span class="fu">filter</span>(end <span class="sc">!=</span> <span class="st">&quot;&quot;</span> <span class="sc">&amp;</span> death <span class="sc">!=</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>##    id age sex ph.ecog ph.karno    wt.loss  medication first_diag      death
## 1 106  74   1       1       76 12.1418510  crizotinib 2010-01-09 2010-10-15
## 2 294  70   1       1       80 24.2845210  crizotinib 2004-07-23 2005-08-18
## 3 468  51   1       1       78  0.6657683 entrectinib 2007-11-20 2008-09-17
##          end
## 1 3021-05-03
## 2 3021-05-03
## 3 3021-05-03</code></pre>
<p>The end date for these three participants cannot be correct. It might be plausible that the death dates are correct and one could proceed by simply working with those (discarding the end dates for these three participants). To be safe, in absence of further information, we delete these three observations.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-preparation-1.html#cb21-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span> <span class="fu">filter</span>(end <span class="sc">==</span> <span class="st">&quot;&quot;</span> <span class="sc">|</span> death <span class="sc">==</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We now create a column <code>event</code> with ones if a death date was reported and zeros otherwise. We then create the <code>fu</code> column, calculating the follow up time for each observation. We finally delete the <code>first_diag</code>, <code>end</code> and <code>death</code> columns.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-preparation-1.html#cb22-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">ifelse</span>(death <span class="sc">!=</span> <span class="st">&quot;&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb22-2"><a href="data-preparation-1.html#cb22-2" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>fu[merged<span class="sc">$</span>event<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">with</span>(merged, <span class="fu">difftime</span>(death[event<span class="sc">==</span><span class="dv">1</span>], </span>
<span id="cb22-3"><a href="data-preparation-1.html#cb22-3" aria-hidden="true" tabindex="-1"></a>                                                    first_diag[event<span class="sc">==</span><span class="dv">1</span>], <span class="at">units =</span> <span class="st">&quot;weeks&quot;</span>))</span>
<span id="cb22-4"><a href="data-preparation-1.html#cb22-4" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>fu[merged<span class="sc">$</span>event<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">with</span>(merged, <span class="fu">difftime</span>(end[event<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb22-5"><a href="data-preparation-1.html#cb22-5" aria-hidden="true" tabindex="-1"></a>                                                    first_diag[event<span class="sc">==</span><span class="dv">0</span>], <span class="at">units =</span> <span class="st">&quot;weeks&quot;</span>))</span>
<span id="cb22-6"><a href="data-preparation-1.html#cb22-6" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">select</span>(merged, <span class="sc">-</span><span class="fu">c</span>(first_diag, end, death))</span></code></pre></div>
<p>Let’s now analyse the <code>fu</code> variable:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-preparation-1.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged<span class="sc">$</span>fu)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##   -59.57    24.14    45.01   361.02    64.71 52668.28</code></pre>
<p>We see that for some observations the follow-up time is negative. Let’s count the number of observations with this property:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-preparation-1.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged<span class="sc">$</span>fu <span class="sc">&lt;</span><span class="dv">0</span>) </span></code></pre></div>
<pre><code>## [1] 34</code></pre>
<p>Since a negative follow up time is not acceptable, in absence of further information (which could be gathered for example by liaising with who created the original datasets) we delete these 34 observations. Note that we do not impute these missing values from other variables, since they are response variables. We will use imputation later for observations missing covariates.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-preparation-1.html#cb27-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">filter</span>(merged, fu <span class="sc">&gt;=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div id="demographic-variables" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Demographic Variables</h2>
<p>Let’s now check the columns relative to demographic aspects.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data-preparation-1.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged<span class="sc">$</span>age)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   36.00   56.00   62.00   62.32   69.00   98.00</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data-preparation-1.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">recode</span>(merged<span class="sc">$</span>sex, <span class="st">&quot;0&quot;</span><span class="ot">=</span><span class="st">&quot;Male&quot;</span>, <span class="st">&quot;1&quot;</span><span class="ot">=</span><span class="st">&quot;Female&quot;</span>))</span></code></pre></div>
<pre><code>## 
## Female   Male 
##    181    282</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-preparation-1.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(merged<span class="sc">$</span>ph.ecog, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>## 
##    0    1    2    3 &lt;NA&gt; 
##  141  224   80   10    8</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-preparation-1.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged<span class="sc">$</span>ph.karno, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   46.00   75.00   83.00   82.55   92.00  100.00       2</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data-preparation-1.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(merged<span class="sc">$</span>wt.loss, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## -28.980   1.968  10.542  10.918  19.756  52.350      30</code></pre>
<p>There are no missing values for age or sex, while we have missing values for ECOG and Karnofsky scores, and for weight loss. Let’s calculate how many observations have at least one of those three values missing:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data-preparation-1.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(merged<span class="sc">$</span>ph.ecog) <span class="sc">|</span> <span class="fu">is.na</span>(merged<span class="sc">$</span>ph.karno) <span class="sc">|</span> <span class="fu">is.na</span>(merged<span class="sc">$</span>wt.loss))</span></code></pre></div>
<pre><code>## [1] 37</code></pre>
<p>There are 37 such observations, which constitute 8% of the observations in <code>merged</code>. We will use multiple imputation in order to leverage the full potential of the information contained in <code>merged</code>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cohort-description-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
